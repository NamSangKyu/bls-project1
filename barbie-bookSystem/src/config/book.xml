<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" 
"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!-- 별칭 지정 -->
<sqlMap namespace="book">
  <typeAlias alias="bookvo" type="model.BookVO"/>
    <select id="bookno" resultClass="int">
    	select bls_book_seq.nextval from dual
    </select>
    <select id="checkBook" parameterClass="int" resultClass="java.util.HashMap">
    	select distinct(isbn), img from BLS_BOOK where isbn = #isbn#
    </select>
    <select id="getBookInfoNum" parameterClass="int" resultClass="HashMap">
    	select title, writer, cont, isbn ,loc, s.subject, p.publisher, img from BLS_BOOK b, BLS_BOOK_PBS p, BLS_BOOK_SBJ s where b.subjectno = s.subjectno and b.publisherno = p.publisherno and bookno=#bookno#
    </select>
    <select id="getBookInfoTitle" parameterClass="java.lang.String" resultClass="java.util.HashMap">
    	select distinct(isbn), title, writer, cont, isbn ,loc, img, s.subject, p.publisher  from BLS_BOOK b, BLS_BOOK_PBS p, BLS_BOOK_SBJ s where b.subjectno = s.subjectno and b.publisherno = p.publisherno and title = #title#
    </select>
	<insert id="insert" parameterClass="java.util.HashMap">
		insert into bls_book values(#bookno#,#vo.isbn#,#vo.title#,#vo.writer#,#vo.cont#,#vo.loc#,#file#,#vo.subjectNo#,#vo.publisherNo#)
	</insert>  	
	<select id="getBookAllList" resultClass="java.util.HashMap">
		select rownum as no, title, writer,loc, b_subject as subject, b_publisher as publisher from (select distinct(isbn), title, writer, cont, isbn ,loc, s.subject as b_subject, p.publisher as b_publisher  from BLS_BOOK b, BLS_BOOK_PBS p, BLS_BOOK_SBJ s where b.subjectno = s.subjectno and b.publisherno = p.publisherno)
	</select>
</sqlMap>


































